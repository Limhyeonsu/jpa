# JPA 소개
## 1.1 SQL을 직접 다룰 때 발생하는 문제점
### 1.1.1 반복, 반복 그리고 반복
데이터베이스는 객체 구조와는 다른 데이터 중심의 구조를 가지므로 객체를 데이터베이스에 직접 저장하거나 조회할 수는 없다. 따라서 개발자가 객체지향 애플리케이션과 데이터베이스 중간에서 SQL과 JDBC API를 사용해서 변환작업을 직접 해주어야한다. 이때 객체를 데이터베이스에 CRUD하려면 너무 많은 SQL과 JDBC API를 코드로 작성해야한다. 또 테이블마다 같은 작업을 반복해야한다.

### 1.1.2 SQL에 의존적인 개발
데이터 접근 계층을 사용해서 SQL을 숨겨도 어쩔수 없이 DAO를 열어서 어떤 SQL이 실행되는지 확인해야할 때가 있다. 이렇게 SQL에 의존하는 상황에서는 개발자들이 엔티티를 신뢰하고 사용할 수 없게 된다. 일일히 DAO를 열어서 어떤 SQL이 실행되는지 확인해야하기 때문에 진정한 의미의 계층 분할이 아니다.

### 1.1.3 JPA와 문제 해결
JPA가 제공하는 API를 사용하면 JPA가 개발자 대신에 적절한 SQL을 생성해서 데이터베이스에 전달한다.

persist() : 저장, find() : 조회, 수정의 경우 별도의 메소드를 제공하지 않고, 객체를 조회해서 값을 변경하면 트랜잭션을 커밋할 때 데이터베이스에 적절한 UPDATE SQL이 전달된다. 또 연관된 객체 조회시는 연관된 객체 사용 시점에 적절한 SELECT SQL을 실행한다.

## 1.2 패러다임의 불일치
객체지향 프로그래밍은 추상화, 캡슐화, 정보은닉, 상속, 다형성 등 시스템의 복잡성을 제어할 수 있는 다양한 장치들을 제공한다. 그래서 현대의 복잡한 애플리케이션은 대부분 객체지향 언어로 개발한다. 관계형 데이터베이스는 데이터 중심으로 구조화되어 있고, 집합적인 사고를 요구한다. 그리고 객체지향에서 이야기하는 추상화, 상속, 다형성 같은 개념이 없다.

[객체와 관계형 데이터베이스의 패러다임 불일치로 발생하는 문제]
1) 상속 : 객체는 상속이라는 기능을 가지고 있지만 테이블은 상속이라는 기능이 없다. 상속관계를 JDBC API를 사용하는 경우 부모 객체에서 부모데이터만 꺼내서 SQL을 작성하고, 자식 객체에서 자식 데이터만 꺼내서 SQL을 작업해야하는 번거로움이 있다. JPA를 사용하면 간단하게 JPA에게 객체를 저장하면 된다. jpa.persist(자식객체)를 하면 부모객체 자식객체를 Insert하고 find()하는 경우 부모 자식 두 테이블을 조인해서 필요한 데이터를 조회하고 결과를 반환한다.
2) 연관관계 : 객체는 참조를 사용해서 다른 객체와 연관관계를 가지고 참조에 접근해서 연관된 객체를 조회하고, 테이블은 외래키를 사용해서 다른 테이블과 연관관계를 가지고 조인을 사용해서 연관된 테이블을 조회한다. 또한 객체는 참조가 있는 방향으로만 조회할 수 있고, 테이블은 외래키 하나로 양쪽으로 조인이 가능하다. 객체를 데이터베이스에 저장하려면 외래키 값으로 변환해야하고, 조회할때는 외래 키 값을 객체의 참조로 변환해서 객체에 보관해야한다. 이를 JPA가 처리 함
3) 객체 그래프 탐색 : 객체의 연관관계로 탐색할 수 있는데 이를 객체 그래프 탐색이라고 한다.객체는 마음껏 객체 그래프를 탐색할 수 있어야한다. 처음 실행하는 SQL에 따라 객체 그래프를 어디까지 탐색할 수 있는지 정해지게되고 이것은 객체지향 개발자에게 큰 제약이된다. 하지만 JPA를 사용하면 객체 그래프를 마음껏 탐색할 수 있다. JPA는 연관된 객체를 사용하는 시점에 적절한 SELECT SQL을 실행하여 연관된 객체를 마음껏 조회할 수 있다. (실제 객체를 사용하는 시점까지 데이터베이스 조회를 미룬다고 해서 지연 로딩이라 함)
4) 비교 : 데이터베이스는 기본 키의 값으로 각 로우를 구분하고, 객체는 동일성 비교(==)와 동등성 비교(equals)라는 두 가지 비교 방법이 있다. 예)member1과 member2를 같은 데이터베이스의 로우를 조회한 경우 객체 측면에서 둘은 다른 인스턴스이기 때문에 동일성 비교하면 false가 된다. 이때 JPA는 같은 트랜잭션일 때 같은 객체가 조회되는 것을 보장하여 위 문제를 해결해준다.

## 1.3 JPA란 무엇인가
JPA는 자바 진영의 ORM 기술 표준이다. ORM은 객체와 관계형 데이터베이스를 매핑하는 것으로 ORM프레임워크는 객체와 테이블을 매핑해서 패러다임의 불일치 문제를 개발자 대신 해결해주고, SQL을 대신 생성해서 데이터베이스에 전달해 준다. 다양한 ORM프레임워크중 하이버네이트 프레임워크가 가장 많이 사용된다.

__JPA 소개__ : JPA는 자바 ORM 기술에 대한 API표준 명세다.(인터페이스를 모아둔 것) 따라서 JPA를 사용하려면 JPA를 구현한 ORM 프레임워크로 하이버네이트가 있음

__왜 JPA를 사용해야하는가?__
* 생산성 : JPA를 사용하면 간단하게 JPA에게 저장할 객체를 전달하면 CRUD용 SQL을 개발자가 직접 작성하지 않아도 되고, DDL문도 자동으로 생성해주는 기능도 있어 편리하다.
* 유지보수 : SQL을 직접 다루는 경우에는 필드를 하나만 추가해도 관련된 코드를 모두 변경해야하는 번거로움이 있으나 JPA를 사용하면 이러한 과정을 JPA가 대신 처리해주어 수정할 코드가 줄어든다.
* 패러다임의 불일치 해결
* 성능 : 애플리케이션과 데이터베이스 사이에서 다양한 성능 최적화 기회를 제공한다.
* 데이터 접근 추상화의 벤더 독립성 : 애플리케이션과 데이터베이스 사이에 추상화된 데이터 접근 계층을 제공해서 애플리케이션이 특정 데이터베이스 기술에 종속되지 않도록 한다.
* 표준 : JPA는 자바 진영의 ORM 기술 표준이고, 다른 구현기술로 손쉽게 변경할 수 있다.